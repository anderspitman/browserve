<!doctype html>
<html>
  <head>
    <title>Reverserver Test</title>
    <link rel="stylesheet" type="text/css" href="/styles.css">
    <meta charset="UTF-8"> 
  </head>
  <body>
    <input id='file_button' type='file'></input>
    <div id='example_command'></div>
    <script src='/main.js'></script>
    <script>

    const host = window.location.hostname;
    const port = 8080;
    const rsServer = new reverserver.Server({ host, port });

    const file = new File(["Hi there"], "og.txt", {
      type: "text/plain",
    });

    rsServer.hostFile('/', file);

    const uploadButton = document.getElementById('file_button');
    uploadButton.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) {
        return;
      }

      const url = '/' + file.name;
      rsServer.hostFile(url, file);

      const exampleCommandEl = document.getElementById('example_command');
      const fullUrl = rsServer.getHostedUrl(url);
      exampleCommandEl.innerHTML =
        `samtools view http://${window.location.hostname}:${port}${fullUrl} 2:1-100000`;
    });

    </script>
  </body>
</html>
